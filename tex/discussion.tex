% GUIDELINES:
% This section may be divided by subheadings. Discussions should cover the key findings of the study: discuss any prior research related to the subject to place the novelty of the discovery in the appropriate context, discuss the potential shortcomings and limitations on their interpretations, discuss their integration into the current understanding of the problem and how this advances the current views, speculate on the future direction of the research, and freely postulate theories that could be tested in the future.

%%%%%%%%%%%
% Would be nice to have empirical studies/relevant examples about:
% --- Evolutionary change ----
% - how repeated bouts of directional selection affect evolutionary change (mutation accumulation/phenotypic volatility/sweeps)
% - Adaptive plasticity can stabilize populations against fluctuations
% - Relaxed selection in plastic genes (or difficulty in maintaining costly plasticity)
% --- Novel traits ----
% - changing environments + fitness landscape exploration
% - plasticity stabilizes populations => allows further adaptation
% --- Deleterious genes ----
%%%%%%%%%%%

%%%%%%%%%
% Text to work in:

% -- coalescence times --
% In asexual populations without ecological interactions fostering coexistence, phylogenies should coalesce periodically; that is, the most recent common ancestor shared by the extant population should change.
% The rate that these coalescence events occur can indicate the strength of selection.
% For example, populations under strong selective pressures should experience more rapid coalescence events than populations under weaker selection \citep{dolson_interpreting_2020}.


%%%%%%%%%

% @AML: This section is missing empirical examples.
\section{Discussion}

% TODO - Remove subheadings from discussion
%  - make flow without subheadings
%  - Move discussion headings up to results?

Our results indicate that adaptive plasticity can improve evolution's ability to maintain and refine novel traits, though with the tradeoff of reducing evolutionary exploration of the fitness landscape.
These dynamics appear to be driven by the stabilizing effect that adaptive plasticity had on population dynamics rather than plasticity's effect on genetic architecture or regulation.
Below we discuss the specific implications of the results from each of our three experiments.

\subsection{The evolution of adaptive phenotypic plasticity slows evolutionary change in fluctuating environments}

% -- Overview of main evolutionary change results --
Adaptively plastic populations experienced fewer selective sweeps and fewer total genetic changes relative to non-plastic populations evolving in the same environmental conditions.
Plastic populations adapted to environmental changes by relying on environmentally-induced cues and within-lifetime regulation, which also stabilized these populations against fluctuations. 
Because ENV-A and ENV-B were incompatible (i.e., adaptive phenotypes in ENV-A were maladaptive in ENV-B and vice versa), non-plastic generalists did not evolve; any non-plastic generalist (e.g., that performed all tasks or performed no tasks) would have been quickly outcompeted by a specialist strategy because of the large fitness benefit for performing environment-specific tasks (and only those tasks).
As such, non-plastic populations repeatedly required genetic modifications to respond to environmental changes and thus exhibited frequent selective sweeps during each new readaptation.
Indeed, across all three of our experiments, the evolutionary dynamics of plastic populations were more similar to that of populations evolving in a static environment than to that of non-plastic populations evolving in an identical fluctuating environment.

% -- [Architecture results] --

% Indeed, previous work experimentally demonstrated the \textit{de novo} evolution of adaptive phenotypic plasticity under these conditions in Avida \citep{clune_investigating_2007,lalejini_evolutionary_2016}.
% Here, we shift from focusing on the evolutionary causes of phenotypic plasticity to investigate its evolutionary consequences.

% -- in context of previous digital evolution work --
This study is the first in-depth empirical investigation into how the \textit{de novo} evolution of adaptive plasticity shifts the course of subsequent evolution in a cyclic environment.
The evolutionary dynamics that we observed in non-plastic populations, however, are consistent with results from previous digital evolution studies. 
\cite{dolson_interpreting_2020} proposed a suite of lineage and phylogeny metrics for quantifying the evolutionary histories of evolving populations of digital organisms; consistent with our findings, they observed that non-plastic populations that were evolved in cyclically changing environments exhibited higher phenotypic volatility and mutation accumulation than that of populations evolved in static conditions.
\cite{lalejini_evolutionary_2016} visually inspected the evolutionary histories of non-plastic organisms evolved in fluctuating environments, observing that mutations readily switched the set of traits expressed by offspring.
\cite{canino-koning_evolution_2016} investigated how different types of changing environments shape the genetic architectures of evolved organisms, showing that cyclically-changing environments can steer populations toward genotypes that more readily mutate to alternative phenotypes.
\cite{canino-koning_evolution_2016} also observed that genomes evolved in harsh cyclic environments often contained vestigial fragments of genetic material adapted to prior environments.

%  - @Austin - depending on what you include about architecture results, you'll also want to work in results from Canino-Koning (2019); going to talk about their novel tasks results in next subsection.

% -- In context of conventional evolutionary theory: evo response => f(selection, variation) --
Our results are also consistent with conventional evolutionary theory.
A trait's evolutionary response to selection depends on the strength of directional selection and on the amount of genetic variation for selection to act upon \citep{lande_measurement_1983,zimmer_evolution_2013}.
In our experiments, non-plastic populations repeatedly experienced strong directional selection to toggle which tasks were expressed after each environmental change.
As such, retrospective analyses of successful lineages revealed rapid evolutionary responses (that is, high rates of genetic and phenotypic changes).
% WOULD BE NICE: [relevant examples of these dynamics from literature].
% - Rapid evolutionary change (strong directional selection) => rapid genetic and phenotypic responses.
% Indeed, many empirical studies demonstrating rapid evolutionary responses to directional selection [????].
Evolved adaptive plasticity shielded populations from strong directional selection when the environment changed by eliminating the need for a rapid evolutionary response to toggle task expression.
Indeed, both theoretical and empirical studies have shown that adaptive plasticity can constrain evolutionary change by weakening directional selection on evolving populations \citep{price_role_2003,paenke_influence_2007,ghalambor_non-adaptive_2015}. 

% This result is consistent with both theoretical models predicting that adaptive plasticity can constrain evolutionary change by reducing directional selection on evolving populations .
% A recent empirical study with \textit{Poecilia reticulata} found that adaptive plasticity 
% Our results are also consistent with empirical studies demonstrating the potential for reduced evolutionary divergence in adaptively plastic traits \citep{ghalambor_non-adaptive_2015}.
% [Ghalambor (2015 - guppies].
% [For example], \cite{ghalambor_non-adaptive_2015} transplanted \textit{Poecilia reticulata} adapted to living with cichlid predators to cichlid-free streams and tested for subsequent evolutionary changes in gene expression patterns.
% After three to four generations, Ghalambor \textit{et al.} found that...

% After each environmental change, any accumulated cryptic variation in plastic genotypes would have been exposed to selection, potentially resulting in a rapid an evolutionary response \citep{wund_assessing_2012}.
% However, we did not find compelling evidence for this effect in our experiments, as the evolutionary dynamics of plastic populations were generally comparable to that of non-plastic populations evolving in static environments.

% -- Evidence for relaxed selection --
We observed evidence of mutation accumulation in plastic lineages that resulted in the loss of unexpressed traits that would have been important for survival in the alternate environment.
These mutations would have proven detrimental when the environment changed.
However, because our analyses focused retrospectively on successful lineages, nearly all of these mutations were followed by a compensatory mutation that restored the lost trait before the environment changed and it needed to be expressed.
% Environmental fluctuations in our experiments were tuned to be frequent enough so that genes needed to function appropriately in the off environment were not lost from the population due to relaxed selection (whether those genes were unexpressed or associated with task regulation) [See supplemental ???].
We tuned the frequency of environmental fluctuations so that genes that needed to function appropriately in the off environment were able to remain in the population despite relaxed selection [See supplemental ???].
Additionally, we imposed no explicit costs on phenotypic plasticity, which minimized selection against the maintenance of plastic genes during the periods between environmental changes.  
% [relevant examples of these dynamics/predictions about how results change if plasticity is costly?].

\vspace{0.25cm}
\subsection{Adaptively plastic populations retain more novel traits than non-plastic populations in fluctuating environments}

% @AML: todo - make sure to work in that co-occurring trait loss could be a result of non-plastic orgs repurposing traits

% -- overview --
% - Exploration -
In our second experiment, we evaluated if adaptive plasticity influences fitness landscape exploration and exploitation by testing the ability of different treatment populations to evolve and then maintain novel tasks. 
In fluctuating environments, we found that non-plastic populations explored more of the fitness landscape than adaptively plastic populations, as measured by the number of novel tasks discovered.
% Specifically, non-plastic populations discovered more novel tasks. %than adaptively plastic populations.

% - Exploitation -
Despite lower overall task discovery, we found that adaptively plastic populations better exploited the fitness landscape, retaining a greater number of novel tasks than non-plastic populations evolving under identical environmental conditions.
%Evolution in non-plastic populations was dominated by repeated bouts of strong directional selection, since it occurred on each of the six base tasks after each environmental change.
Evolution in non-plastic populations was dominated by numerous bouts of strong directional selection.  
This effect was driven by repeated environmental changes; after each change, the performance of the six base tasks needed to be realigned. 
In our experiment, novel tasks were less important to survival than the fluctuating base tasks.
In non-plastic populations, mutations that improve an offspring's fitness after an environmental change are enormously beneficial. 
As such beneficial mutations fix, they can carry with them co-occurring deleterious mutations that knock out novel tasks. % to fixation because there is no horizontal gene transfer in our system (that is, all mutations are linked).
Indeed, we found that mutations associated with novel task loss along successful lineages from non-plastic populations co-occurred with mutations that helped offspring adapt to environmental changes an overwhelming 97\% of the time.

% -- Changing environments promote evolutionary change --
\cite{nahum_improved_2017} demonstrated that a single temporary environmental change can improve fitness landscape exploration and exploitation in evolving populations of non-plastic digital organisms.
% insert more changing environments promote evo change results
In our system, however, we found that \textit{repeated} fluctuations reduced the ability of non-plastic populations to maintain and exploit tasks; that said, we did find that repeated fluctuations may improve overall task discovery. 
Consistent with our findings, \cite{canino-koning_fluctuating_2019} found that non-plastic populations of digital organisms evolving in a harsh cyclic environment maintained fewer novel traits than populations evolving in static environments.
% [@Austin: one or two more relevant examples => computational stuff is fine]
% [relevant literature on changing environments + fitness landscape exploration].
% - [Kashtan et al 2007] - temporally varying goals speed up evolutionary adaptation

% -- Plastic rescue, stabilizing effect of plasticity --
Our results suggest that adaptive phenotypic plasticity can improve the potential for populations to exploit novel resources by stabilizing them against stressful environmental changes.
The stability that we observe may also lend some support to the hypothesis that phenotypic plasticity can rescue populations from extinction under changing environmental conditions [cite].
%While our experiments do not explore the likelihood of extinction, we did observe that the stabilizing effect of adaptive phenotypic plasticity allowed populations to more effectively exploit novel resources.
% [relevant examples from literature?]
% - Evolutionary computation?
% - Wet lab systems?
% - Theoretical models?

% -- relevance to genes as followers hypothesis --.
Our data do not necessarily provide evidence for or against the genes as followers hypothesis.
The genes as followers hypothesis focuses on contexts where plastic populations experience novel or abnormally stressful environmental change.
However, in our system, environmental changes were cyclic (not novel), and the magnitude of changes were consistent for the entirety of the experiment (so none were abnormally stressful).
% During the second phase of our experiment, no offspring experienced an environment that was not experienced by many of their ancestors.
Further, the introduction of novel tasks during the second phase of the experiment merely added additional static opportunities for fitness improvement and did not change the meaning of existing environmental cues. %or it merely added additional static opportunities for fitness improvement.
%; that is, the novel environmental conditions (i.e., the introduction of novel tasks) did not change the background fluctuating environment.
% [most scenarios hypothesized where plasticity promotes adaptive evolution, change in environment changes phenotypic expression, exposing unexpressed variation; however, this was not the case for this experiment. Novel environmental conditions did not change sensory input].
% Less evolutionary change + lower task discovery

\vspace{0.25cm}
\subsection{Non-plastic populations experience more deleterious gene accumulation in fluctuating environments}

% -- Overview of results --
%   - More accumulation in non-plastic
%   - no evidence for cryptic variation housing poison
%   - plastic ~~ static
In our third experiment, we evaluated if adaptive plasticity influences the accumulation of explicitly deleterious genes (\code{poison} instructions) in evolving genomes.
We found that non-plastic lineages that evolved in a fluctuating environment exhibited both larger totals and higher rates of \code{poison} accumulation than that of adaptively plastic lineages.
We did not find evidence of \code{poison} instructions accumulating as cryptic variation in plastic lineages.
Indeed, \code{poison} accumulation in the lineages of adaptively plastic genotypes did not differ significantly from that of the lineages of genotypes evolved in static conditions.

% -- Elaboration on non-plastic result --
% - accumulation in non-plastic treatment driven by genetic hitchhiking
%We hypothesize that \code{poison} instruction accumulation along non-plastic lineages in changing environments was primarily driven by deleterious genetic hitchhiking.
We hypothesize that deleterious genetic hitchhiking drove \code{poison} instruction accumulation along non-plastic lineages in changing environments.
In asexual populations without horizontal gene transfer, all co-occurring mutations are linked.
As such, deleterious mutations linked with a stronger beneficial mutation (i.e., a driver) can sometimes `hitchhike' to fixation \citep{smith_hitch-hiking_1974,van_den_bergh_experimental_2018,buskirk_hitchhiking_2017}.
Natural selection normally prevents deleterious mutations from reaching high frequencies, as such mutants would be outcompeted.
However, when a beneficial mutation sweeps to fixation in a clonal population, it carries along any linked genetic material, including other beneficial, neutral, or deleterious mutations  \cite{barton_genetic_2000, smith_hitch-hiking_1974}.

% Across our experiments, the rapid frequency of selective sweeps in non-plastic populations that evolved in changing environments afforded more opportunities for genetic hitchhiking than that of populations evolving under other treatments. 
Across our experiments, the selective sweeps in non-plastic populations provided additional opportunities for genetic hitchhiking with each environmental change. 
Indeed, across our experiments, successful lineages from non-plastic populations in the cyclic environment exhibited higher mutation accumulation, novel trait loss, and \code{poison} instruction accumulation than their plastic counterparts.
In aggregate, we found that many ($\sim$49\%; XX / XX) mutations that increased \code{poison} instruction execution in offspring co-occurred with mutations that provided an even stronger benefit by adapting the offspring to an environmental change.
This rate of co-occurrence is conservative because we did not analyze mutations that became linked in different generations.

% Phenotypic plasticity can be encoded in genomes in two ways: ...

% -- Elaboration on plastic result --
We found that adaptive phenotypic plasticity reduced \code{poison} instruction accumulation by reducing the rate of evolutionary change, which in turn reduced opportunities for \code{poison} instructions to hitchhike to fixation.
We did not find compelling evidence of cryptic variation harboring \code{poison} instructions in adaptively plastic lineages.
We have two hypotheses for why we did not observe the accumulation of \code{poison} instructions in unexpressed plastic responses.
First, the period of time between environmental changes was too fast for variants carrying unexpressed \code{poison} instructions to reach high frequencies before the environment changed, after which such variants would have been outcompeted.
Second, the plastic machinery that evolves in Avida is typically well-integrated and highly specific; that is, plastic genomes usually adjust their phenotypic expression by toggling a minimal number of key instructions ([though, toggling of larger sequences is possible but more complex]) [cite - supplement].
As such, there is minimal genomic space for variation to accumulate in preexisting (but currently unexpressed) regulated regions.


% [Several possibilities for why we did not observe poison instruction accumulation in unexpressed genetic variation.]
% [Length of the period between switches; rapid enough such that any unexpressed poison instructions would be revealed to selection before time to reach high frequency in population].
% [Underlying mechanisms of plasticity that evolve in avida typically result in small regions of regulation; not actually a large number of unexpressed instructions. Conditional logic instructions toggle a single instruction. Large regions of regulation are possible, but they require more complicated genetic architecture, combining sensory instructions, conditional logic, and jump statements, and templating.]
% [Here is where we would back this up with number of instructions that are toggled in plastic genotypes]
% [Because adaptively plastic populations already well-adapted, not many large effect mutations available to drive hitchhiking].

\vspace{0.25cm}
\subsection{Limitations and future directions}

% --- editing with Charles bookmark ---

% -- Adaptive vs non-adaptive plasticity --
Our conclusions are limited to \textit{adaptively} plastic populations.
We did not explore the effects of non-adaptive plasticity where environmental changes induced phenotypes that were further away from the local optimum.
Non-adaptive plasticity can increase a population's extinction risk, especially if the misaligned plastic response is strongly tied to survival or the population is not sufficiently large \citep{gomulkiewicz_when_1995,chevin_adaptation_2010}.
If the population persists, however, non-adaptive plasticity has been shown to be capable of accelerating evolutionary change by increasing the strength of directional selection. \citep{ghalambor_non-adaptive_2015}.

% -- Environmental change --
Environmental cues in our experiments were reliable, and environmental changes were consistent over time; that is, sensory instructions perfectly differentiated between ENV-A and ENV-B, and environmental fluctuations never exposed populations to entirely new conditions.
Both the reliability of cues and the timescales of environment switching are known to influence evolutionary outcomes \citep{li_digital_2004,boyer_adaptation_2021} [cite - cue reliability].
For example, \cite{boyer_adaptation_2021} evolved populations of \textit{Saccharomyces cerevisiae} in an environment that fluctuated between two growth conditions, observing that both environmental predictability and switching rate influenced the rates of evolutionary responses as well as adaptive outcomes at the genotypic and phenotypic levels. % e.g., generalist (rapid switching) vs. specialist (long periods in each env)
% In plastic populations, switching rate determines maintenance of plastic genes
In adaptively plastic populations, environmental switching rate can influence how plastic responses are maintained: long periods between switches can (but not always \citep{grant_maintenance_2020}) result in the loss of plasticity [citations].
% @AML: I do not like the way this next sentence reads atm. I don't necessarily want to lay claim to these extensions (maybe Austin does?), happy for other folks to do them.
[Given the flexibility of digital evolution techniques, next steps could extend our study to include different forms of plasticity (e.g., adaptive vs. non-adaptive), more complex environments with more than two possible states, stochastic environmental changes, and a range of environment switching rates.]

% - limitation: focus on lineages -
%   - extend to complete evolutionary histories
We focused our analyses on the lineages of final dominant genotypes.
These successful lineages represented the majority of the evolutionary histories of populations at the end of our experiment, as populations did not exhibit long-term coexistence of different clades.
Our analyses, therefore, gave us an accurate picture of [what fixed in the population].
We did not, however, examine the lineages of extinct clades.
Future work will extend our analyses to include extinct lineages, giving us a more complete view of evolutionary history, which may allow us to better distinguish adaptively plastic populations from populations evolving in a static environment by measuring [variance in reproductive success within populations over time, ...].

% - Machinery -
% @AML: Goal of this paragraph - get into the weeds about how plasticity generally gets implemented in avida (because it almost certainly matters). But also be as reader-friendly as possible because reading about low-level mechanisms when you're unfamiliar with a system can suck.
As with most [evolution/wet-lab/??] experiments, our results are in the context of a particular model organism: ``Avidian'' self-replicating computer programs.
Digital organisms in Avida regulate responses to environmental cues using a combination of sensory instructions and conditional logic instructions (\code{if} statements).
The \code{if} instructions conditionally execute a single instruction depending on previous computations and the state of memory.  
As such, plastic genomes typically regulate a small number of key instructions that, when executed, change the expressed phenotype [supplement? or I'll write a mini OSF document with old data to cite].
[This way of achieving plasticity more often results in 
small, independently regulated single-instruction sequences 
than in
large, sequences of co-regulated instructions (which is possible but more complicated to encode).]
This bias [toward high-specificity regulation] may limit the accumulation of hidden genetic variation in Avida genomes. 
However, as there are many model biological organisms, there are many model [computational] organisms (e.g., [citations]) that have different regulatory mechanisms that can be used to test the generality of our results.
[A broad sentence to wrap everything up?]
% e.g., A sentence about how we hope this work inspires more use of digital evolution as an experimental tool/expand experimental repertoire of evolutionary biologists studying phenotypic plasticity?
% e.g., As demonstrated here, Digital evolution studies allow us to directly manipulate the capacity for plastic responses to evolve and perfectly observe subsequent dynamics, enabling us to experimentally test hypotheses that were previously relegated to theoretical analyses.

